# ðŸ“Š Example: Multiple Work Groups with Individual Budgets

> [!WARNING]
> This example was generated by Claude AI. I haven't reviewed it fully but took a glance at it and it looks mostly right.

This example demonstrates how to schedule work into multiple groups, each with their own time and count budgets.

## Setup Work Groups in INI

First, define your work groups in your project's INI configuration:

```ini
[/Script/GWBRuntime.GWBManager]
; High priority work group for critical systems
+WorkGroupDefinitions=(Id="CriticalSystems",Priority=100,MaxFrameBudget=0.002,MaxWorkUnitsPerFrame=3)

; Medium priority work group for general gameplay
+WorkGroupDefinitions=(Id="Gameplay",Priority=50,MaxFrameBudget=0.003,MaxWorkUnitsPerFrame=5)

; Low priority work group for background processing
+WorkGroupDefinitions=(Id="Background",Priority=10,MaxFrameBudget=0.005,MaxWorkUnitsPerFrame=10)
```

## C++ Implementation

```cpp
// Schedule critical system work (gets priority)
for (auto& CriticalTask : CriticalTasks)
{
    UGWBManager::ScheduleWork(
        this,
        "CriticalSystems", // High priority work group
        FGWBWorkOptions::EmptyOptions
    ).OnHandleWork([CriticalTask]() {
        // Critical work that must be done quickly
        CriticalTask->ProcessImportantData();
    });
}

// Schedule gameplay work (medium priority)
for (auto& GameplayTask : GameplayTasks)
{
    UGWBManager::ScheduleWork(
        this,
        "Gameplay", // Medium priority work group
        FGWBWorkOptions::EmptyOptions
    ).OnHandleWork([GameplayTask]() {
        // Regular gameplay processing
        GameplayTask->UpdateGameplayLogic();
    });
}

// Schedule background work (lowest priority)
for (auto& BackgroundTask : BackgroundTasks)
{
    UGWBManager::ScheduleWork(
        this,
        "Background", // Low priority work group
        FGWBWorkOptions::EmptyOptions
    ).OnHandleWork([BackgroundTask]() {
        // Background processing that can wait
        BackgroundTask->ProcessNonEssentialData();
    });
}
```

## How It Works

1. **Priority-Based Execution**: Work groups are processed in priority order (CriticalSystems â†’ Gameplay â†’ Background)
2. **Individual Budgets**: Each group has its own time and count budget:
   - CriticalSystems: 2ms, max 3 work units per frame
   - Gameplay: 3ms, max 5 work units per frame  
   - Background: 5ms, max 10 work units per frame
3. **Budget Isolation**: If one group exhausts its budget, other groups can still execute within their limits
4. **Frame Budget Distribution**: Total frame budget is distributed across groups based on their individual limits

## Expected Behavior

- Critical systems always get processed first when budget is available
- Gameplay work runs after critical systems, within its own budget
- Background work only runs if there's remaining frame budget
- Each group respects its individual work unit count limits
- Frame spikes are prevented by the combined budget management

## Monitoring

Use these console commands to monitor group performance:

```
stat GameWorkBalancer
gwb.enabled 1
gwb.budget.frame 0.010  // Increase overall frame budget if needed
```

This pattern is ideal for games that need to prioritize different types of work while maintaining smooth frame rates.